<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xBrush Admin Dashboard</title>
    
    <!-- External CSS -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="model-showcase.css">
    <link rel="stylesheet" href="premium-models.css">
    <link rel="stylesheet" href="css/validation.css">
    
    <style>
        body {
            background: #f7fafc;
            min-height: 100vh;
        }
        
        .admin-header {
            background: #2d3748;
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .admin-title {
            font-size: 2rem;
            font-weight: 700;
            margin: 0;
        }
        
        .admin-subtitle {
            opacity: 0.8;
            margin-top: 5px;
        }
        
        /* Tab Navigation */
        .admin-nav-tabs {
            background: white;
            border-radius: 8px;
            padding: 5px;
            display: flex;
            gap: 5px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: #718096;
            font-weight: 500;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        .tab-btn:hover {
            background: #f7fafc;
        }
        
        .tab-btn.active {
            background: #667eea;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Stats Cards */
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .stat-label {
            color: #718096;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .stat-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 8px;
        }
        
        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }
        
        .badge-success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }
        
        /* Controls Section */
        .admin-controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .search-box {
            flex: 1;
            min-width: 200px;
            max-width: 400px;
        }
        
        .search-box input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.95rem;
        }
        
        .admin-actions {
            display: flex;
            gap: 10px;
        }
        
        /* Table Styles */
        .models-table {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow: hidden;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: #f7fafc;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #4a5568;
            border-bottom: 1px solid #e2e8f0;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        tr:hover {
            background: #f7fafc;
        }
        
        .model-thumbnail {
            width: 60px;
            height: 80px;
            object-fit: cover;
            border-radius: 4px;
        }
        
        .model-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .model-details h4 {
            margin: 0;
            font-size: 1rem;
            color: #2d3748;
        }
        
        .model-details p {
            margin: 2px 0;
            font-size: 0.85rem;
            color: #718096;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .status-active {
            background: #c6f6d5;
            color: #276749;
        }
        
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-inactive {
            background: #e2e8f0;
            color: #718096;
        }
        
        .action-btn {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            margin: 0 2px;
            border: none;
        }
        
        .action-btn.approve {
            background: #48bb78;
            color: white;
        }
        
        .action-btn.reject {
            background: #f56565;
            color: white;
        }
        
        .action-btn.view {
            background: #4299e1;
            color: white;
        }
        
        .action-btn.premium {
            background: #667eea;
            color: white;
        }
        
        /* Plan Review Styles */
        .review-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .review-queue {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .review-item {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .review-item:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .model-meta {
            display: flex;
            gap: 15px;
        }
        
        .model-avatar {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
        }
        
        .tier-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .tier-basic {
            background: #e5e7eb;
            color: #4b5563;
        }
        
        .tier-professional {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .tier-enterprise {
            background: #fef3c7;
            color: #92400e;
        }
        
        .tier-celebrity {
            background: #ede9fe;
            color: #6b21a8;
        }
        
        .plan-details {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .detail-label {
            color: #6b7280;
            font-size: 0.875rem;
        }
        
        .detail-value {
            font-weight: 600;
            color: #1f2937;
        }
        
        .review-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn-approve {
            background: #10b981;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-approve:hover {
            background: #059669;
        }
        
        .btn-reject {
            background: #ef4444;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-reject:hover {
            background: #dc2626;
        }
        
        .btn-request-info {
            background: #f59e0b;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-request-info:hover {
            background: #d97706;
        }
        
        /* Navigation buttons */
        .nav-btn {
            display: inline-block;
            padding: 8px 16px;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .nav-btn.btn-primary {
            background: #667eea;
            color: white;
        }
        
        .nav-btn.btn-outline {
            background: transparent;
            color: white;
            border: 1px solid white;
        }
        
        .nav-btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <!-- Admin Header -->
    <header class="admin-header">
        <div class="admin-container">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1 class="admin-title">xBrush Admin Dashboard</h1>
                    <p class="admin-subtitle">통합 관리자 대시보드</p>
                </div>
                <div style="display: flex; gap: 10px;">
                    <a href="index.html" class="nav-btn btn-outline">← 메인으로</a>
                    <a href="models.html" class="nav-btn btn-primary">모델 목록</a>
                </div>
            </div>
        </div>
    </header>

    <div class="admin-container">
        <!-- Tab Navigation -->
        <div class="admin-nav-tabs">
            <button class="tab-btn active" data-tab="dashboard">대시보드</button>
            <button class="tab-btn" data-tab="models">모델 관리</button>
            <button class="tab-btn" data-tab="plan-review">플랜 검토</button>
            <button class="tab-btn" data-tab="users">사용자 관리</button>
            <button class="tab-btn" data-tab="analytics">분석</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalModels">0</div>
                    <div class="stat-label">전체 모델</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="activeModels">0</div>
                    <div class="stat-label">활성 모델</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="pendingModels">0</div>
                    <div class="stat-label">승인 대기</div>
                    <span class="stat-badge badge-warning">검토 필요</span>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="premiumModels">0</div>
                    <div class="stat-label">프리미엄 모델</div>
                </div>
            </div>

            <div class="review-section">
                <h2>빠른 작업</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                    <button class="btn btn-primary" onclick="switchTab('models')">모델 승인하기</button>
                    <button class="btn btn-primary" onclick="switchTab('plan-review')">플랜 검토하기</button>
                    <button class="btn btn-primary" onclick="exportData()">데이터 내보내기</button>
                    <button class="btn btn-primary" onclick="viewAnalytics()">분석 보기</button>
                </div>
            </div>
        </div>

        <!-- Models Management Tab -->
        <div id="models" class="tab-content">
            <div class="admin-controls">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="모델 이름, 이메일로 검색..." onkeyup="searchModels()">
                </div>
                <div class="admin-actions">
                    <select id="statusFilter" onchange="filterModels()">
                        <option value="all">모든 상태</option>
                        <option value="pending">승인 대기</option>
                        <option value="active">활성</option>
                        <option value="inactive">비활성</option>
                    </select>
                    <button class="btn btn-primary" onclick="exportModels()">내보내기</button>
                </div>
            </div>

            <div class="models-table">
                <table>
                    <thead>
                        <tr>
                            <th>모델 정보</th>
                            <th>상태</th>
                            <th>카테고리</th>
                            <th>등록일</th>
                            <th>티어</th>
                            <th>작업</th>
                        </tr>
                    </thead>
                    <tbody id="modelsTableBody">
                        <!-- Models will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Plan Review Tab -->
        <div id="plan-review" class="tab-content">
            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-value" id="pendingPlans">0</div>
                    <div class="stat-label">검토 대기 플랜</div>
                    <span class="stat-badge badge-warning">긴급</span>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="approvedToday">0</div>
                    <div class="stat-label">오늘 승인됨</div>
                    <span class="stat-badge badge-success">완료</span>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="rejectedToday">0</div>
                    <div class="stat-label">오늘 거절됨</div>
                    <span class="stat-badge badge-danger">거절</span>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgReviewTime">0</div>
                    <div class="stat-label">평균 검토 시간</div>
                </div>
            </div>

            <div class="review-section">
                <h2>라이선스 플랜 검토 대기열</h2>
                <div class="review-queue" id="reviewQueue">
                    <!-- Plan review items will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Users Tab -->
        <div id="users" class="tab-content">
            <div class="review-section">
                <h2>사용자 관리</h2>
                <p>사용자 관리 기능은 개발 중입니다.</p>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="review-section">
                <h2>분석 대시보드</h2>
                <p>분석 기능은 개발 중입니다.</p>
            </div>
        </div>
    </div>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <!-- Application Scripts -->
    <script src="js/config.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/firebase-model-storage.js"></script>
    <script src="js/model-storage-adapter.js"></script>
    <script src="utils.js"></script>

    <script>
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Activate corresponding button
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // Load data for the tab
            if (tabName === 'models') {
                loadModels();
            } else if (tabName === 'plan-review') {
                loadPlanReviews();
            } else if (tabName === 'dashboard') {
                loadDashboardStats();
            }
        }

        // Add event listeners to tab buttons
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tabName = btn.getAttribute('data-tab');
                switchTab(tabName);
            });
        });

        // Load dashboard stats
        async function loadDashboardStats() {
            try {
                const models = await window.modelStorageAdapter.getAllModels();
                const activeModels = models.filter(m => m.status === 'active');
                const pendingModels = models.filter(m => m.status === 'pending');
                const premiumModels = models.filter(m => m.tier === 'premium' || m.tier === 'vip');
                
                document.getElementById('totalModels').textContent = models.length;
                document.getElementById('activeModels').textContent = activeModels.length;
                document.getElementById('pendingModels').textContent = pendingModels.length;
                document.getElementById('premiumModels').textContent = premiumModels.length;
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Load models for management
        async function loadModels() {
            try {
                const models = await window.modelStorageAdapter.getAllModels();
                displayModels(models);
            } catch (error) {
                console.error('Error loading models:', error);
                showToast('모델 로딩 중 오류가 발생했습니다.', 'error');
            }
        }

        // Display models in table
        function displayModels(models) {
            const tbody = document.getElementById('modelsTableBody');
            
            if (models.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 40px;">등록된 모델이 없습니다.</td></tr>';
                return;
            }
            
            tbody.innerHTML = models.map(model => `
                <tr>
                    <td>
                        <div class="model-info">
                            <img src="${model.thumbnailUrl || model.profileImage || '/images/default-avatar.png'}" 
                                 alt="${model.name}" class="model-thumbnail">
                            <div class="model-details">
                                <h4>${model.name || model.personalInfo?.name || '이름 없음'}</h4>
                                <p>${model.email || model.personalInfo?.email || '이메일 없음'}</p>
                            </div>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge status-${model.status}">
                            ${model.status === 'active' ? '활성' : model.status === 'pending' ? '대기' : '비활성'}
                        </span>
                    </td>
                    <td>${(model.categories || model.personalInfo?.categories || []).join(', ') || '-'}</td>
                    <td>${formatDate(model.createdAt || model.registrationDate)}</td>
                    <td>
                        <span class="tier-badge tier-${model.tier || 'basic'}">
                            ${getTierName(model.tier)}
                        </span>
                    </td>
                    <td>
                        ${model.status === 'pending' ? 
                            `<button class="action-btn approve" onclick="approveModel('${model.id}')">승인</button>
                             <button class="action-btn reject" onclick="rejectModel('${model.id}')">거절</button>` :
                            `<button class="action-btn view" onclick="viewModel('${model.id}')">보기</button>
                             <button class="action-btn premium" onclick="togglePremium('${model.id}')">프리미엄</button>`
                        }
                    </td>
                </tr>
            `).join('');
        }

        // Load plan reviews
        async function loadPlanReviews() {
            try {
                // This would normally fetch from a plans collection
                const models = await window.modelStorageAdapter.getAllModels();
                const pendingPlans = models.filter(m => m.planStatus === 'pending' || m.status === 'pending');
                
                document.getElementById('pendingPlans').textContent = pendingPlans.length;
                document.getElementById('approvedToday').textContent = '0'; // Would calculate from real data
                document.getElementById('rejectedToday').textContent = '0';
                document.getElementById('avgReviewTime').textContent = '2.5시간';
                
                displayPlanReviews(pendingPlans);
            } catch (error) {
                console.error('Error loading plan reviews:', error);
            }
        }

        // Display plan reviews
        function displayPlanReviews(plans) {
            const reviewQueue = document.getElementById('reviewQueue');
            
            if (plans.length === 0) {
                reviewQueue.innerHTML = '<p style="text-align: center; padding: 40px; color: #718096;">검토 대기 중인 플랜이 없습니다.</p>';
                return;
            }
            
            reviewQueue.innerHTML = plans.map(plan => `
                <div class="review-item">
                    <div class="review-header">
                        <div class="model-meta">
                            <img src="${plan.thumbnailUrl || plan.profileImage || '/images/default-avatar.png'}" 
                                 alt="${plan.name}" class="model-avatar">
                            <div>
                                <h3>${plan.name || plan.personalInfo?.name || '이름 없음'}</h3>
                                <p style="color: #6b7280; margin-top: 4px;">
                                    ${plan.email || plan.personalInfo?.email || '이메일 없음'}
                                </p>
                            </div>
                        </div>
                        <span class="tier-badge tier-${plan.requestedTier || plan.tier || 'professional'}">
                            ${getTierName(plan.requestedTier || plan.tier || 'professional')}
                        </span>
                    </div>
                    
                    <div class="plan-details">
                        <div class="detail-row">
                            <span class="detail-label">신청 플랜</span>
                            <span class="detail-value">${getTierName(plan.requestedTier || plan.tier || 'professional')}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">월 예상 수익</span>
                            <span class="detail-value">₩${((plan.pricing?.basePrice || 100000) * 10).toLocaleString()}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">포트폴리오</span>
                            <span class="detail-value">${plan.portfolio?.images?.length || 0}개 이미지</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">신청일</span>
                            <span class="detail-value">${formatDate(plan.createdAt || plan.registrationDate)}</span>
                        </div>
                    </div>
                    
                    <div class="review-actions">
                        <button class="btn-approve" onclick="approvePlan('${plan.id}')">
                            ✓ 승인
                        </button>
                        <button class="btn-reject" onclick="rejectPlan('${plan.id}')">
                            ✗ 거절
                        </button>
                        <button class="btn-request-info" onclick="requestMoreInfo('${plan.id}')">
                            📋 추가 정보 요청
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Model management functions
        async function approveModel(modelId) {
            try {
                await window.modelStorageAdapter.updateModel(modelId, { status: 'active' });
                showToast('모델이 승인되었습니다.', 'success');
                loadModels();
            } catch (error) {
                console.error('Error approving model:', error);
                showToast('승인 중 오류가 발생했습니다.', 'error');
            }
        }

        async function rejectModel(modelId) {
            if (!confirm('정말 이 모델을 거절하시겠습니까?')) return;
            
            try {
                await window.modelStorageAdapter.updateModel(modelId, { status: 'rejected' });
                showToast('모델이 거절되었습니다.', 'success');
                loadModels();
            } catch (error) {
                console.error('Error rejecting model:', error);
                showToast('거절 중 오류가 발생했습니다.', 'error');
            }
        }

        // Plan review functions
        async function approvePlan(planId) {
            try {
                await window.modelStorageAdapter.updateModel(planId, { 
                    planStatus: 'approved',
                    status: 'active',
                    approvedAt: new Date().toISOString()
                });
                showToast('플랜이 승인되었습니다.', 'success');
                loadPlanReviews();
            } catch (error) {
                console.error('Error approving plan:', error);
                showToast('플랜 승인 중 오류가 발생했습니다.', 'error');
            }
        }

        async function rejectPlan(planId) {
            const reason = prompt('거절 사유를 입력해주세요:');
            if (!reason) return;
            
            try {
                await window.modelStorageAdapter.updateModel(planId, { 
                    planStatus: 'rejected',
                    rejectionReason: reason,
                    rejectedAt: new Date().toISOString()
                });
                showToast('플랜이 거절되었습니다.', 'success');
                loadPlanReviews();
            } catch (error) {
                console.error('Error rejecting plan:', error);
                showToast('플랜 거절 중 오류가 발생했습니다.', 'error');
            }
        }

        function requestMoreInfo(planId) {
            const info = prompt('요청할 추가 정보를 입력해주세요:');
            if (!info) return;
            
            showToast('추가 정보 요청이 전송되었습니다.', 'success');
        }

        // Helper functions
        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR');
        }

        function getTierName(tier) {
            const tierNames = {
                basic: '베이직',
                professional: '프로페셔널',
                premium: '프리미엄',
                enterprise: '엔터프라이즈',
                celebrity: '셀러브리티',
                vip: 'VIP'
            };
            return tierNames[tier] || '베이직';
        }

        function viewModel(modelId) {
            window.open(`model-detail.html?id=${modelId}`, '_blank');
        }

        function togglePremium(modelId) {
            if (typeof togglePremiumStatus === 'function') {
                togglePremiumStatus(modelId);
            } else {
                alert('프리미엄 관리 기능을 로드 중입니다...');
            }
        }

        // Search functionality
        function searchModels() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#modelsTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // Filter functionality
        function filterModels() {
            const filterValue = document.getElementById('statusFilter').value;
            const rows = document.querySelectorAll('#modelsTableBody tr');
            
            rows.forEach(row => {
                if (filterValue === 'all') {
                    row.style.display = '';
                } else {
                    const statusBadge = row.querySelector('.status-badge');
                    const status = statusBadge ? statusBadge.classList[1].replace('status-', '') : '';
                    row.style.display = status === filterValue ? '' : 'none';
                }
            });
        }

        // Export functions
        function exportModels() {
            showToast('모델 데이터를 내보내는 중...', 'info');
            // Implementation would export to CSV/Excel
        }

        function exportData() {
            showToast('전체 데이터를 내보내는 중...', 'info');
            // Implementation would export all data
        }

        function viewAnalytics() {
            switchTab('analytics');
        }

        // Initialize on load
        window.addEventListener('firebaseReady', function() {
            loadDashboardStats();
        });

        // Also check if Firebase is already ready
        if (window.firebaseDB) {
            loadDashboardStats();
        }
    </script>
</body>
</html>